# Methodology for GTEx Gene Expression Analysis Pipeline

## 1. Summary
This analysis pipeline characterizes biological function by grouping genes based on their tissue-specific expression profiles using data from the Genotype-Tissue Expression (GTEx) project. The workflow proceeds through four distinct stages: (1) extraction and aggregation of raw expression data, (2) unsupervised hierarchical clustering of expression patterns, (3) statistical validation of cluster cohesion, and (4) functional enrichment analysis using external knowledge bases (STRING and Enrichr).

## 2. Data Extraction and Preprocessing
Raw gene expression data is sourced from the GTEx project (Adult Data) in the form of Transcripts Per Million (TPM). 
- **Aggregation**: For a defined list of candidate genes, expression values are aggregated per tissue type. The central tendency for each gene-tissue pair is calculated using the median TPM (default) or mean TPM to reduce the impact of outliers and individual biological variation.
- **Transformation**: Prior to clustering, the aggregated expression matrix ($N_{genes} \times M_{tissues}$) undergoes a $log_2(x + 1)$ transformation to stabilize variance across the dynamic range of expression levels.
- **Standardization**: A row-wise Z-score standardization is applied to each gene. This scales the expression profile such that the mean is 0 and the standard deviation is 1 for every gene. This step isolates the shape of the tissue-specificity profile (relative expression) from the absolute magnitude of expression.

## 3. Unsupervised Clustering
Genes are grouped into expression programs using Hierarchical Agglomerative Clustering.
- **Distance Metric**: Euclidean distance is calculated between gene vectors to quantify similarity in tissue expression profiles.
- **Linkage Method**: Wardâ€™s minimum variance method is employed to minimize the total within-cluster variance.
- **Cluster Definition**: The resulting dendrogram is cut at specific heights to produce a user-defined number of clusters ($k$). This approach allows for the interrogation of biological signals at varying levels of granularity (e.g., broad tissue groups vs. specific cell types).

## 4. Statistical and Qualitative Validation
### 4.1. Silhouette Analysis
- **Metric**: The silhouette coefficient ($s$) is calculated for each gene to quantify how well it fits its assigned cluster relative to the nearest neighboring cluster.
- **Visualization**: Silhouette scores are visualized as horizontal bar plots to identify "core" cluster members (high scores) and ambiguous genes (low/negative scores). Average silhouette scores are reported per cluster to quantify overall cluster compactness and separation.

### 4.2. Noise Visualization
- **Methodology**: Expression profiles of all genes within a cluster are plotted as individual lines across all tissues. A red "mean trend" line is overlaid to qualitatively assess the coherence of the expression program and identify clusters with high background noise.

## 5. Functional Enrichment Analysis
Biological interpretation of the defined clusters is performed using two independent enrichment methodologies.

### 5.1. Network Enrichment (STRING)
- **Methodology**: Gene lists from each cluster are queried against the STRING database to identify Protein-Protein Interaction (PPI) networks.
- **Significance**: Enrichment is determined using a hypergeometric test. Terms are considered significant if the False Discovery Rate (FDR) is $\le 0.05$.

### 5.2. Annotation Enrichment (Enrichr)
- **Methodology**: Gene sets are analyzed for over-representation against multiple annotated libraries. Key libraries include:
    - Gene Ontology (2025): Biological Process, Molecular Function, Cellular Component.
    - Pathways: KEGG (2025 Human), Reactome, WikiPathways.
    - Phenotypes: Human Phenotype Ontology, OMIM Disease.
- **Significance**: Terms are filtered based on an adjusted p-value (Benjamini-Hochberg method) $\le 0.05$. For every term, four scores are recorded: p-value, q-value (adjusted p-value), rank Z-score, and Combined Score.
- **Ranking**: Results are ranked by the **Combined Score** ($c = \log(p) \times z$), which balances the deviation from the expected rank with the statistical significance.

### 5.3. ID Resolution (OLS)
To improve legibility, ontology identifiers (e.g., HP, EFO, DOID) are resolved into human-readable labels using the EMBL-EBI Ontology Lookup Service (OLS) API.

## 6. Integration and Reporting
Final biological descriptions are generated by synthesizing three data points for each cluster:
1. **Top Tissues**: The tissues with the highest mean Z-score expression values within the cluster.
2. **Cohesion**: The average silhouette score of the cluster.
3. **Pathways**: The top statistically significant terms from STRING and Enrichr, reported with their adjusted p-values/FDR and Enrichr Combined Scores.

This synthesis produces a descriptive profile characterizing the tissue-specific regulatory program captured by each cluster.
